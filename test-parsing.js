// Test script for OCR line item parsing
import { parseOCRToLineItems } from './src/utils/ocrLineItemParser';

// Test with sample OCR data
const testOCRData = {
  "status": "success",
  "data": {
    "1": {
      "page": 1,
      "content": "National Catastrophe Team\n\nP.O. Box 672041\nDallas, Texas 75267\nPhone: (800) 547-8676\nFax: (877) 292-9527\n\nInsured: JEANETTE SCHNELLMANN\nProperty: 2029 LAKE FOREST DR\nGROVETOWN, GA 30813-1240\nHome: 2029 LAKE FOREST DR\nGROVETOWN, GA 30813-1240\n\nHome: (727) 742-3426\nE-mail: JAS8843@AOL.COM\n\nClaim Rep.: Sean Brown\nPosition: Virtual Claims Adjuster\nCompany: Allstate National Catastrophe Team\nBusiness: PO Box 672041\nDallas, TX 75267-0241\nBusiness: (877) 447-9386 x 1212055\nE-mail: claims@claims.allstate.com\n\nEstimator: Sean Brown\nPosition: Virtual Claims Adjuster\nCompany: Allstate National Catastrophe Team\nBusiness: PO Box 672041\nDallas, TX 75267-0241\nBusiness: (877) 447-9386 x 1212055\nE-mail: claims@claims.allstate.com\n\nClaim Number: 0771546900 Policy Number: 000815531304 Type of Loss: WINDSTORM AND HAIL\nInsurance Company: Allstate Indemnity Company\n\nDate Contacted: 10/11/2024 2:04 PM\nDate of Loss: 9/27/2024 5:23 AM Date Received: 10/6/2024 11:13 AM\nDate Inspected: 10/12/2024 2:05 PM Date Entered: 10/9/2024 7:11 PM\nDate Est. Completed: 11/7/2024 7:07 PM\n\nPrice List: GAAU8X OCT24\nEstimate: Restoration/Service/Remodel\nJEANETTE\nSCHNELLMAN2\n\nJEANETTE_SCHNELLMAN2 1/30/2025 Page: 1\n"
    },
    "5": {
      "page": 5,
      "content": "Your guide to reading your adjuster summary.*\n\nInsured: John Smith Home: (123) 123-4567\nProperty: 1234 Oak Street Business: (123) 123-4567\nAnytown, Anystate 12345\n\nA. CLAIM NUMBER\nB. DAMAGE LOCATION\nThe claim number assigned to your loss.\nThe area that has been damaged.\nC. UNIT COST\nClaim Number: 1234567890 Policy Number: 000000123456789 Type of Loss: Wind Damage\nD. REPLACEMENT COST VALUE\nE. ACTUAL CASH VALUE\nThis amount reflects the cost of an item.\nCost to repair or replace covered property\ndamages.\nF. DEPRECIATION\nRoof\nMain Home\n\nMain\n1588.42 Surface Area 15.88 Number of Squares\n173.41 Total Perimeter Length 65.71 Total Ridge Length\n\nDESCRIPTION QUANTITY UNIT RCV AGE/LIFE COND DEP% DEPREC. ACV\n1. Remove 3 tab-25 yr. composition\nshingle roofing-ind. felt 15.88SQ 53.97 857.04 0/25 yrs Avg NA (0.00) 857.04\n2. 3 tab-25 yr-comp. shingle roofing-\nwout felt 18.33SQ 219.11 4,016.29 2/25 yrs Avg 8% (165.16) 3,851.13\n3. Roofing felt 15 lb. 15.88SQ 32.88 522.13 2/20 yrs Abv. Avg. 10% (15.98) 506.15\nTotal: Roof 5,395.46 181.14 5,214.32\nBedroom\nDESCRIPTION QUANTITY UNIT RCV AGE/LIFE COND DEP% DEPREC. ACV\n4. R&R drywall-hung taped, floated,\nready for paint 685.47SF 3.25 2,248.34 2/150 yrs Avg 1.33% (7.04) 2241.30\n5. Sml/prime then paint the walls and\nceiling (2 coats) 685.47SF .90 616.12 2/15 yrs Avg. 13.33% (13.71) 603.21\n6. Haul debris-per pickup truck load\nincluding dump fees 1.00 EA 147.92 147.92 Q/NA Avg. NA (0.00) 147.92\nTotal: Bedroom 3.013.18 20.75 2.992.43\nContents\nDESCRIPTION QUANTITY UNIT RCV AGE/LIFE COND DEP% DEPREC. ACV\n7. Queen Serta Perfect Sleeper Regal\nSuite Double Sided Plush Mattress\nUS Mattress-4/9/2018 1.00 EA 799.00 799.00 2/20 Abv. Avg 6% (47.94) 751.06\nOrig Desc- Queen Serta Perfect Sleeper\nSuite\nTotal: Contents 799.00 47.94 751.06\n\nSummary for Dwelling\nK Summary for All Items\nLine Item Total 8,408.64\nMaterial Sales Tax 199.85 L\nGeneral Contractor Overhead 860.85\nGeneral Contractor Profit 860.85\nReplacement Cost Value M $10,330.19\nLess Depreciation (201.89)\nActual Cash Value $10.128.30\nLess Deductible N (500,00)\nNet Claim $9,628.30\nTotal Recoverable Depreciation O 201.89\nNet Claim if Depreciation is Recovered $9.830.19\n\nSummary for Contents\nSummary for All Items\nLine Item Total 799.00\nMaterial Sales Tax 55.93 P\nReplacement Cost Value $854.93\nLess Depreciation (47.94)\nActual Cash Value $806.99\nNet Claim Q $806.99\nTotal Recoverable Depreciation 47.94\nNet Claim if Depreciation is Recovered $854.93\nXactware\nLF = Linear Feet SQ = 100 Square Feet SF = Square Feet SY = Square Yard EA = Each\n*This is a sample guide to your adjuster summary\n©2018 Allstate Insurance Company, allstate.com 09/2018\nThis amount reflects the Replacement Cost Value\nless the amount of any Depreciation.\nThis amount reflects any deductions from\nReplacement Cost Value to account for the\ndecrease in the property's value due to various\nfactors including, but not limited to, age, life\nexpectancy, wear and tear (condition), and\nor economic obsolescence.\nDepreciation may apply to both Structure and\nContents items. Your estimate was completed\nbased on the information you provided regarding\nthe age and condition of the depreciated items.\nG. CONDITION\nThe category or state of an item with regard to\nfunctional\n\nits appearance, quality, or working order.\nCondition options are new, above average,\naverage and below average.\nH. AGE\nThis represents the age and average life\nexpectancy of the particular line item at the time\nof loss.\nI. REPAIR OR REPLACE ACTIONS\nDescribes the repairs and/or replacement\nmaterials and actions.\nJ. DAMAGE LOCATION TOTALS\nTotal before adding any applicable taxes and/or\ndepreciation.\nK. SUMMARY OF INVOLVED COVERAGE\nThe involved policy coverage for the damaged\narea.\nL. CONTRACTORS OVERHEAD AND PROFIT\nWhen appropriate, general contractors overhead\nand profit may be included to account for the\nservices of a general contractor\nM. TOTAL WITH TAX\nThe total estimate with any applicable tax and/or\noverhead and profit.\nN. DEDUCTIBLE APPLIED\nReflects the applicable policy deductible applied.\nO. RECOVERABLE DEPRECIATION\nTotal amount of depreciation that is recoverable.\nDepending on your policy language, you may be\nable to recover your depreciation upon your\nrepair or replacement of the depreciated items.\nP. SALES TAX\nBased upon where the loss occurred, the sales\ntax laws may vary by state regarding the\napplication of sales tax to materials and labor.\nQ. NET CLAIM FOR INVOLVED COVERAGE\nThe total replacement cost less recoverable and\nnon-recoverable depreciation and any applicable\ndeductible equals the amount of the settlement\nfor the involved coverage.\n"
    },
    "6": {
      "page": 6,
      "content": "National Catastrophe Team\nAllstate. P.O. Box 672041\nYou're in good hands.\nDallas, Texas 75267\nPhone: (800) 547-8676\nFax: (877) 292-9527\nJEANETTE_SCHNELLMAN2\nSchnellmann\nExterior\n\nHouse - Roof\n3246.08 Surface Area 32.46 Number of Squares\n262.11 Total Perimeter Length 45.73 Total Ridge Length\n145.69 Total Hip Length\n\nDESCRIPTION QUANTITY UNIT RCV AGE/LIFE COND. DEP % DEPREC. ACV\nTemp Repairs\n1. R&R Tarp -all-purpose poly - per sq ft 100.00 SF 1.00 100.00 0/NA Avg. 0% (0.00) 100.00\n(labor and material)\nAllowing to install tarp for temporary repairs related to the loss.\nRoof Replacement\n2. Remove 3 tab - 25 yr. - composition shingle 32.46 SQ 55.67 1,807.05 16/25 yrs Avg. NA (0.00) 1,807.05\nroofing - incl. felt\n3. Roofing felt - 15 lb. 32.46 SQ 29.70 964.06 16/20 yrs Avg. 80% (771.25) 192.81\n4. 3 tab - 25 yr. - comp. shingle roofing - 35.00 SQ 203.21 7,112.35 16/25 yrs Avg. 64% (4,551.90) 2,560.45\nw/out felt\nAuto Calculated Waste: 7.8%, 2.54SQ\nOptions: Valleys: Closed-cut (half laced), Include eave starter course: Yes, Include rake starter course: No, Include ridge/hip cap: No, Exposure - Hip/Valley/Starter:\n5\"\nBundle Rounding: 0.7%, 0.24SQ (included in waste calculation above)\nThis line item includes an allowance of $95.16 per unit, which reflects current market values in your area. Market prices were verified by Material Supply Warehouse\n(MSW). While you or your contractor are under no obligation to use this supplier, MSW allows you or your contractor of choice to have materials delivered to your\nhome for installation. For more information on MSW, please visit www.materialsupplywarehouse.com, or contact them at info@materialsupplywarehouse.com, or\n888-508-5009.\n5. Hip / Ridge cap-cut from 3 tab - 191.41 LF 3.79 725.44 16/25 yrs Avg. 64% (464.28) 261.16\ncomposition shingles\nThis line item includes an allowance of $95.16 per unit, which reflects current market values in your area. Market prices were verified by Material Supply Warehouse\n(MSW). While you or your contractor are under no obligation to use this supplier, MSW allows you or your contractor of choice to have materials delivered to your\nhome for installation. For more information on MSW, please contact them at info@materialsupplywarehouse.com, or 888-508-5009.\n6. R&R Drip edge 262.11 LF 2.91 762.74 16/35 yrs Avg. 45.71% (307.94) 454.80\n7. Detach & Reset Exhaust cap through roof - 2.00 EA 69.08 138.16 0/35 yrs Avg. 0% (0.00) 138.16\nup to 4\"\n8. R&R Flashing - pipe jack 3.00 ΕΑ 51.94 155.82 16/35 yrs Avg. 45.71% (61.29) 94.53\n9. Detach & Reset Roof vent - turtle type- 7.00 EA 48.54 339.78 0/35 yrs Avg. 0% (0.00) 339.78\nMetal\n10. R&R Rain cap - 6\" 4.00 EA 53.04 212.16 16/35 yrs Avg. 45.71% (87.55) 124.61\n11. Remove Additional charge for steep roof - 32.46 SQ 14.38 466.77 16/NA Avg. NA (0.00) 466.77\n7/12 to 9/12 slope\n12. Additional charge for steep roof - 7/12 to 32.46 SQ 37.69 1,223.42 16/NA Avg. 0% (0.00) 1,223.42\n9/12 slope\nTotals: House - Roof 14,007.75 6,244.21 7,763.54\n\nJEANETTE_SCHNELLMAN2 1/30/2025 Page: 6\n"
    }
  }
};

console.log('=== TESTING OCR LINE ITEM PARSING ===');

try {
  const lineItems = parseOCRToLineItems(testOCRData);
  console.log(`✅ Successfully extracted ${lineItems.length} line items`);
  
  lineItems.forEach((item, index) => {
    console.log(`${index + 1}. ${item.line_number}. ${item.description}`);
    console.log(`   Quantity: ${item.quantity} ${item.unit}`);
    console.log(`   RCV: $${item.RCV}, ACV: $${item.ACV}`);
    console.log(`   Category: ${item.category}, Location: ${item.location_room || 'N/A'}`);
    console.log('');
  });
  
} catch (error) {
  console.error('❌ Parsing failed:', error);
}
