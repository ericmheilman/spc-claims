version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "Installing Python 3.9..."
        - sudo apt-get update
        - sudo apt-get install -y python3.9 python3.9-venv python3-pip
        - sudo ln -sf /usr/bin/python3.9 /usr/bin/python3
        - sudo ln -sf /usr/bin/python3.9 /usr/bin/python
        - echo "Setting up Python PATH..."
        - export PATH="/usr/bin:$PATH"
        - python --version
        - python3 --version
        - which python
        - which python3
        - echo "Python dependencies are built-in modules (no pip install needed)"
        - echo "Installing Node.js dependencies..."
        - npm ci
    build:
      commands:
        - echo "Setting up Python PATH for build..."
        - export PATH="/usr/bin:$PATH"
        - echo "Building the app..."
        - npm run build
  artifacts:
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
      - .next/cache/**/*
